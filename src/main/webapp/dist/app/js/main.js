webpackJsonp([13],[function(a,i,e){function s(){var a=new $.Deferred;return WXID?a.resolve({wxId:WXID,from:"url"}):CODE?pageManager.ajaxManager({url:l.accessPermission.getWxId.url,data:{code:CODE},type:"get",success:function(i){if(0===i.code){var e=i.data.WXId;window.WXID=e,a.resolve({wxId:e,from:"code"})}else a.reject(i.data)},fail:function(i){a.reject(i)}}):a.reject(WXID),a.promise()}function t(){var a=new $.Deferred;return pageManager.ajaxManager({url:l.accessPermission.getTicket.url,type:"post",data:{url:location.href.split("#")[0]},dataType:"json",success:function(i){0===i.code&&a.resolve(i.data)},fail:function(i){a.reject(i)}}),a.promise()}var n=e(1),l=e(2);window.pageManager=e(3);var c="air-good",o=n.utils,d=o.getInfoFromURL();l.accessPermission={getWxId:{url:"equimentRest/restEquiment/pageToken/getCode",param:["code"]},getTicket:{url:"equimentRest/restEquiment/weixin/getTicket"}},window.CODE=d.param.code,window.WXID=d.param.wxId,window.shareURL=location.href,window.shareOption={title:document.title,desc:"空气猫检测系列管理平台",link:location.href,imgUrl:d.path+"equimentRest/dist/app/images/product02.jpg"},s().then(function(a){if(a&&"code"===a.from)return void(location.href=location.href.replace(/code=(.*?)(?=&|$|#)/,"wxId="+window.WXID));var i=d.hash||c;pageManager._go(i),$(window).on("hashchange",pageManager.onHashChange)},function(){pageManager.showTooltip('"微信绑定超时数据异常！请返回主页从新登录！错误代码：1", "error"')}),t().then(function(a){wx.config({beta:!0,debug:!1,appId:a.appid,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","closeWindow"]}),wx.ready(function(){wx.invoke("setNavigationBarColor",{color:"green"}),wx.onMenuShareTimeline(window.shareOption),wx.onMenuShareQQ(window.shareOption),wx.onMenuShareAppMessage(window.shareOption)})},function(){console.warn("获取js ticket失败")})}]);
//# sourceMappingURL=main.js.map