webpackJsonp([10],{0:function(a,i,e){function t(a){var i=JSON.stringify(a),e=location.href.split("#")[0]+"#p6-play?coverPage=true&page=p6-play&share=true&data="+i;return e}function s(a,i,e){var t=echarts.init($(a)[0]),s={title:{text:i.text+"-48小时记录",textStyle:{color:"#ffffff",fontSize:16},x:"center",bottom:0},color:["#ffffff"],grid:{left:"40",right:"2%",bottom:"60",containLabel:!1},xAxis:[{type:"category",data:i.data.x,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:["#ffffff"]}},axisLable:{show:!1}}],yAxis:[{type:"value",name:"",position:"left",axisLine:{lineStyle:{color:["#ffffff"]}},axisLabel:{textStyle:{color:["#ffffff"]}}}],series:[{name:"pm2.5",type:"bar",barWidth:5,data:i.data.y}]};t.setOption(s)}function n(a,i,e,t,s){function n(a,i){var e=a.find(".out-cricle");e.attr({style:"transform: rotate(0deg)"}),setTimeout(function(){e.attr({style:"transform: rotate("+i+"deg); transition: all 2s ease"})},500)}function l(a){var i=[["安全","优"],["轻度","中等"],["重度","严重"]];return"ch2"===s||"tvoc"===s||"pollutionLevel"===s?i[a][0]:i[a][1]}function r(a,i){var e={ch2:{name:"甲醛",standard:"0.1mg/m³",solution:"净化措施或通风换气",justDoIt:"通风换气"},tvoc:{name:"化学污染物",standard:"0.6mg/m³",solution:"净化措施或通风换气",justDoIt:"通风换气"},pm25:{name:"PM2.5",standard:"75μg/m³",solution:"净化措施",justDoIt:"净化措施"}},t=["{{name}}国家标准为{{standard}}，您所处的环境安全。请继续保持哦！","您所处的环境{{name}}超标，请及时采取{{solution}}。说真的，我都替你着急！","您的您所处的环境{{name}}超标严重，请立刻{{justDoIt}}。赶紧的吧！急死我了！！"];for(var s in e){var n=[],l=e[s];t.forEach(function(a){var i=a.replace(/\{\{([^\{]+)\}\}/g,function(a,i){return l[i]});n.push(i)}),e[s]=n}var r=["good-message","remind-message","Warning-message"][i],o=e[a];if(o){o=o[i];var c='<p class="'+r+'">'+o+"</p>";$(".page-p6-data").find("."+a+"-message").html(c)}}var o=$(a),c=i[0],d=i[1],p=parseFloat(t),u=180*(p-c)/(d-c);if(o.find(".big-number").text(isNaN(p)?"--":t),isNaN(p)&&(u=0),180>=u?n(o,u):n(o,180),isNaN(p))o.addClass("dial-box-white");else{if(".dial-box1"===a){for(var f=[0,35,75,115,150,250,1e3],m=["优","良","轻度污染","中度污染","重度污染","严重污染"],v=[75,150],b="",g=0,x=g+1;g<f.length-1;g++,x=g+1)if(p>=f[g]&&p<=f[x]){o.find(".small-number").text(m[g]),p<=v[0]?(b="dial-box-blue",r(s,0)):p>v[0]&&p<=v[1]?(b="dial-box-yellow",r(s,1)):(b="dial-box-red",r(s,2));break}return void o.addClass(b)}p<e[0]?(o.addClass("dial-box-blue"),o.find(".small-number").text(l(0)),r(s,0)):e[0]<=p&&p<e[1]?(o.addClass("dial-box-yellow"),o.find(".small-number").text(l(1)),r(s,1)):(o.addClass("dial-box-red"),o.find(".small-number").text(l(2)),r(s,2))}}function l(){function a(){d.requestBackend({url:c.equipmentData.getEquimentData.url,param:{erId:u.erId||0,eupId:u.eupId||0,mac:u.mac||0},success:function(a){function i(a,i){$(i).text(a||0)}var e=a.equimentData;if(e&&"[object Object]"!==Object.prototype.toString.call(e))return void d.showTooltip("数据有误");var s=[{selector:".dial-box1",frontRange:[0,999],backRange:[76,150],value:e.pm25,type:"pm25"},{selector:".dial-box2",frontRange:[0,3],backRange:[.1,.2],value:e.ch2,type:"ch2"},{selector:".dial-box3",frontRange:[0,10],backRange:[.6,2],value:e.tvoc,type:"tvoc"},{selector:".dial-box4",frontRange:[0,500],backRange:[101,201],value:e.pollutionLevel,type:"pollutionLevel"},{selector:".dial-box5",frontRange:[-20,50],backRange:[1/0,1/0],value:e.temperature,type:"temperature"},{selector:".dial-box6",frontRange:[0,100],backRange:[1/0,1/0],value:e.humity,type:"humity"}];f.circleBoardModel=s,s.forEach(function(a){n(a.selector,a.frontRange,a.backRange,a.value,a.type)}),0!=u.isPrimary&&($(".page-p6-data #equipmentName").hide(),$(".page-p6-data #p6DataShutdown").hide(),$(".page-p6-data #p6DataSheScreenOff").hide(),$(".page-p6-data #p6DataSheScreen").hide());try{$(".page-p6-data #equipmentName").text(f.equipmentName=""===e.position.trim()?"未命名":e.position),f.uploadTime=e.uploadTime,i(e.uploadTime,".page-p6-data .link-info")}catch(l){}window.shareOption.link=t(f)}})}function i(){d.requestBackend({url:c.equipmentData.getEquimentDetailData.url,param:{erId:u.erId,mac:u.mac,eupId:u.eupId},success:function(a){function i(a){var i={};for(var e in a){var t=a[e],s=t.length,n=/(\d{2})(\d{2})(\d{2})/,l=48,r=new Array(l);if(i[e]={x:[],y:[]},s>0){t=t.sort(function(a,i){var e=n,t=a.time.match(e),s=i.time.match(e),l=parseInt(t[1])-parseInt(s[1]),r=parseInt(t[2])-parseInt(s[2]),o=parseInt(t[3])-parseInt(s[3]);return 0===l?0===r?o:r:Math.abs(l)>2?-l:l});var o,c,d=l-1,p=t.pop(),u=p.time.match(n),f=parseInt(u[3]),m=parseInt(u[2]),v=parseInt(u[1]);do o=(10>v?"0"+v:v.toString())+(10>m?"0"+m:m.toString())+(10>f?"0"+f:f.toString()),c=0,r[d]={time:o,value:c},p&&p.time===o&&(r[d].value=p.value,p=t.pop()),--f<0&&(f=23,1===m&&1===v?(m=31,v=12):m-=1);while(d--);for(var b=0,g=r.length;g>b;b++){var x=r[b].time.match(n)[3]+":00";i[e].x.push(x),i[e].y.push(r[b].value)}}}return i}var e=a.equimentDetailData;if(e&&"[object Object]"!==Object.prototype.toString.call(e))return void d.showTooltip("数据有误");e=i(e);var t=[{selector:"#first-echart-box",data:e.ch2,text:"甲醛",range:[0,4]},{selector:"#second-echart-box",data:e.pollutionLevel,text:"污染指数",range:[0,520]},{selector:"#three-echart-box",data:e.tvoc,text:"TVOC",range:[0,15]},{selector:"#four-echart-box",data:e.humity,text:"湿度",range:[0,110]},{selector:"#five-echart-box",data:e.pm25,text:"PM2.5",range:[0,1030]},{selector:"#six-echart-box",data:e.temperature,text:"温度",range:[-20,60]}];t.forEach(function(a){s(a.selector,a,a.range)})}})}d.setRefreshPage(["p6-data"],function(){a(),i()}),a(),setInterval(a,3e5),i(),setInterval(i,36e5)}function r(){var a=new $.Deferred;return d.ajaxManager({url:c.equipmentData.getTicket.url,type:"post",data:{url:location.href.split("#")[0]},dataType:"json",success:function(i){0===i.code&&a.resolve(i.data)},fail:function(i){a.reject(i)}}),a.promise()}var o=e(14),c=e(2),d=e(3),p=e(1),u=p.utils.getInfoFromURL().param,f={};c.equipmentData={getEquimentData:{url:"equimentRest/restEquiment/equimentData/getEquimentData",param:["erId","eupId","mac"]},getEquimentDetailData:{url:"equimentRest/restEquiment/equimentData/getEquimentDetailData",param:["erId","mac","eupId"]},changeEquipmentName:{url:"equimentRest/restEquiment/equiment/position",param:["eupId","erId","name"]},clientOFF:{url:"equimentRest/restEquiment/equimentComm/off",param:["mac","eupId"]},sheScreen:{url:"equimentRest/restEquiment/equimentComm/bright",param:["mac","eupId"]},sheScreenOFF:{url:"equimentRest/restEquiment/equimentComm/OffBright",param:["mac","eupId"]},getTicket:{url:"equimentRest/restEquiment/weixin/getTicket"}};var m={equipmentName:"",onClickEquipmentName:function(){$("#changeNameWrapper").fadeIn(200)},onClickShare:function(){$("#share").fadeIn(200)},onClickShareWrapper:function(){$("#share").fadeOut(200)},onClickShutdown:function(){$(this).before("<div class='hide-box'></div>"),$(".hide-box").fadeOut(28e3),d.ajaxManager({url:c.equipmentData.clientOFF.url,data:{mac:u.mac,eupId:u.eupId},success:function(a){0!=a.code?alert(a.message):alert("设备关闭成功!"),$(".hide-box").remove()}})},onClickSheScreenOFF:function(){$("#p6DataSheScreen").hide(),$(this).before("<div class='hide-box2'></div>"),$(".hide-box2").fadeOut(28e3),d.ajaxManager({url:c.equipmentData.sheScreenOFF.url,data:{mac:u.mac,eupId:u.eupId},success:function(a){0!=a.code?(alert(a.message),1001==a.code&&($("#p6DataSheScreenOff").hide(),$("#p6DataSheScreen").show())):($("#p6DataSheScreenOff").hide(),$("#p6DataSheScreen").show()),$(".hide-box2").remove()}})},onClickSheScreen:function(){$("#p6DataSheScreenOff").hide(),$(this).before("<div class='hide-box2'></div>"),$(".hide-box2").fadeOut(28e3),d.ajaxManager({url:c.equipmentData.sheScreen.url,data:{mac:u.mac,eupId:u.eupId},success:function(a){0!=a.code?($(".hide-box").remove(),alert(a.message),1001==a.code&&($("#p6DataSheScreen").hide(),$("#p6DataSheScreenOff").show())):($("#p6DataSheScreen").hide(),$("#p6DataSheScreenOff").show()),$(".hide-box2").remove()}})},onClickPrimary:function(){var a=$("#changeNameWrapper input").val();a.length>16&&alert("设备名称不能超过16位"),d.requestBackend({url:c.equipmentData.changeEquipmentName.url,param:{name:a,erId:u.erId,eupId:u.eupId},success:function(i){$("#equipmentName").text(""===a.trim()?"未命名":a),d.showTooltip("修改成功","success")}}),$(".js_dialog").fadeOut(200)},onClickCancel:function(){$(".js_dialog").fadeOut(200)}};d.initPage(o,"p6-data",m,l),r().then(function(a){wx.config({beta:!0,debug:!1,appId:a.appid,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","closeWindow"]}),wx.ready(function(){wx.invoke("setNavigationBarColor",{color:"green"}),wx.onMenuShareTimeline(window.shareOption),wx.onMenuShareQQ(window.shareOption),wx.onMenuShareAppMessage(window.shareOption)})},function(){console.warn("获取js ticket失败")})},14:function(a,i,e){a.exports=' <div class="page p6-data black-bgcolor"> <input type=hidden name=title value=空气猫P6plus型 /> <div class="top-title clearfix"> <a href=javascript:; class="home fl" id=equipmentName data-bind={text:$root.equipmentName,click:$root.onClickEquipmentName}>未定义</a> <span class="link-info fr">3分钟前</span> </div> <div class=dial-listbox> <div class="dial-box dial-box2"> <div class=pie-cricle> <div class=out-cricle></div> <div class=inner-cricle></div> </div> <div class=mark-box> <div class=company>mg/m³</div> <div class=texting-big-num><span class=big-number>0.05</span></div> <div class=texting-num>甲醛<span class=mlr5>|</span><span class=small-number>优</span></div> </div> </div> <div class="dial-box dial-box3"> <div class=pie-cricle> <div class=out-cricle></div> <div class=inner-cricle></div> </div> <div class=mark-box> <div class=company>mg/m³</div> <div class=texting-big-num><span class=big-number>--</span></div> <div class=texting-num>TVOC<span class=mlr5>|</span><span class=small-number>--</span> </div> </div> </div> <div class="dial-box dial-box1"> <div class=pie-cricle> <div class=out-cricle></div> <div class=inner-cricle></div> </div> <div class=mark-box> <div class=company>&mu;g/m³</div> <div class=texting-big-num><span class=big-number>189</span></div> <div class=texting-num>PM2.5<span class=mlr5>|</span><span class=small-number>严重</span> </div> </div> </div> <div class="dial-box dial-box4"> <div class=pie-cricle> <div class=out-cricle></div> <div class=inner-cricle></div> </div> <div class=mark-box> <div class=company></div> <div class=texting-big-num><span class=big-number>430</span></div> <div class=texting-num>污染指数</div> </div> </div> <div class="dial-box dial-box5 dial-box-blue"> <div class=pie-cricle> <div class=out-cricle></div> <div class=inner-cricle></div> </div> <div class=mark-box> <div class=company>℃</div> <div class=texting-big-num><span class=big-number>27</span></div> <div class=texting-num>温度</div> </div> </div> <div class="dial-box dial-box6 dial-box-blue"> <div class=pie-cricle> <div class=out-cricle></div> <div class=inner-cricle></div> </div> <div class=mark-box> <div class=company>%</div> <div class=texting-big-num><span class=big-number>56</span></div> <div class=texting-num>湿度</div> </div> </div> <div class=clearfix></div> </div> <div class=prompt-message> <div class=ch2-message></div> <div class=tvoc-message></div> <div class=pm25-message></div> </div> <div class=echartsbox> <div id=first-echart-box class=first-echart-box></div> <div id=three-echart-box class=three-echart-box></div> <div id=five-echart-box class=five-echart-box></div> <div id=second-echart-box class=second-echart-box></div> <div id=six-echart-box class=six-echart-box></div> <div id=four-echart-box class=four-echart-box></div> </div> <div class=foot-tabbar> <div class="weui-tabbar weui-tabbar-link"> <a href=javascript:; class=weui-tabbar__item id=p6DataShutdown data-bind=click:$root.onClickShutdown> <img src=app/images/Shutdown.png alt="" class=weui-tabbar__icon> <p class=weui-tabbar__label>关机</p> </a> <a href=javascript:; class=weui-tabbar__item id=p6DataSheScreenOff data-bind=click:$root.onClickSheScreenOFF> <img src=app/images/Always.png alt="" class=weui-tabbar__icon> <p class=weui-tabbar__label>设备常亮</p> </a> <a href=javascript:; class=weui-tabbar__item id=p6DataSheScreen style=display:none data-bind=click:$root.onClickSheScreen> <img src=app/images/Always.png alt="" class=weui-tabbar__icon> <p class=weui-tabbar__label>设备关闭</p> </a> <a href=javascript:; class=weui-tabbar__item data-bind=click:$root.onClickShare> <img src=app/images/share.png alt="" class=weui-tabbar__icon> <p class=weui-tabbar__label>分享</p> </a> </div> </div> <div class=none-div></div> <div id=dialogs> <div class=js_dialog id=changeNameWrapper style=display:none> <div class=weui-mask></div> <div class=weui-dialog> <div class=weui-dialog__hd><strong class=weui-dialog__title>请给设备命名</strong></div> <div class=weui-dialog__bd> <input class="weui-input input-text" type=text placeholder=请输入设备名称> </div> <div class=weui-dialog__ft> <a href=javascript:; class="weui-dialog__btn weui-dialog__btn_primary" data-bind=click:$root.onClickPrimary>确定</a> <a href=javascript:; class="weui-dialog__btn weui-dialog__btn_default" data-bind=click:$root.onClickCancel>取消</a> </div> </div> </div> </div> <div id=shareWrapper data-bind=click:$root.onClickShareWrapper> <div class=js_dialog id=share style=display:none> <div class=weui-mask></div> <div class=share-layer> <img class=share-pic src=app/images/sharePic.png> </div> </div> </div> </div> '}});
//# sourceMappingURL=p6-data.js.map